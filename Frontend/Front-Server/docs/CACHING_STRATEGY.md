# Frontend Caching Strategy (Apollo Client)

## 1. 개요

프론트엔드 애플리케이션은 서버 상태 관리 및 캐싱을 위해 **Apollo Client**를 사용합니다. Apollo Client에 내장된 `InMemoryCache`는 GraphQL 쿼리 결과를 클라이언트 측에 저장하여, 동일한 데이터 요청 시 네트워크 호출 없이 즉시 응답하도록 지원합니다. 이를 통해 사용자 경험(UX)을 향상시키고 백엔드 API 서버의 부하를 줄입니다.

또한, Apollo Client 설정에는 `errorLink`가 포함되어 있어 GraphQL 및 네트워크 요청 중 발생하는 모든 에러를 전역적으로 가로채 Redux `notificationSlice`를 통해 사용자에게 알림을 제공하는 역할을 수행합니다.

## 2. 핵심 메커니즘: `InMemoryCache`

-   **구현**: `@apollo/client` 라이브러리의 `InMemoryCache` 클래스
-   **목적**: API로부터 받은 서버 상태를 클라이언트 메모리에 정규화된(normalized) 형태로 저장하고 관리하는 캐시 저장소입니다.
-   **전략**:
    -   **자동 정규화 (Automatic Normalization)**:
        -   `InMemoryCache`는 GraphQL 쿼리 응답에 포함된 `__typename`과 `id` (또는 커스텀 `keyFields`)를 조합하여 각 데이터 객체의 고유 ID를 생성합니다.
        -   이 고유 ID를 키로 사용하여 모든 객체를 평탄화된(flat) 구조로 저장합니다. 예를 들어, 중첩된 응답에 포함된 `Recruit` 객체는 `Recruit:<id>` 와 같은 키로 저장되어 여러 쿼리에서 재사용됩니다.
        -   이를 통해 서로 다른 쿼리가 동일한 데이터를 공유할 수 있으며, 한 객체가 업데이트되면 해당 객체를 사용하는 모든 UI가 자동으로 일관성 있게 업데이트됩니다.
    -   **쿼리 결과 캐싱**: 각 GraphQL 쿼리는 쿼리 이름과 변수의 조합을 키로 하여, 정규화된 객체를 가리키는 포인터들의 집합을 캐시에 저장합니다.
    -   **선언적 데이터 페칭**: React 컴포넌트에서 `useQuery` 훅을 사용하면, Apollo Client가 자동으로 캐시를 먼저 확인합니다.
        1.  **Cache Hit**: 캐시에 유효한 데이터가 있으면, 네트워크 요청 없이 즉시 캐시된 데이터를 반환합니다.
        2.  **Cache Miss**: 캐시에 데이터가 없으면, API 서버로 GraphQL 쿼리를 보냅니다.
        3.  응답을 받으면, 데이터를 정규화하여 캐시에 저장한 후 컴포넌트에 전달하여 렌더링합니다.

## 3. 캐시 관리 정책 (`fetchPolicy`)

`useQuery` 훅의 `fetchPolicy` 옵션을 통해 데이터 요청 시 캐시와 네트워크를 어떻게 사용할지 제어할 수 있습니다.

-   `cache-first` (기본값): 캐시를 먼저 확인하고, 없으면 네트워크 요청. 가장 일반적인 사용 사례.
-   `network-only`: 항상 네트워크 요청을 보내고, 응답을 캐시에 저장. 데이터의 최신성이 매우 중요할 때 사용.
-   `cache-and-network`: 캐시 데이터를 먼저 반환하여 UI를 빠르게 그리고, 그 후 네트워크 요청을 보내 최신 데이터로 UI를 다시 업데이트.
-   `no-cache`: 네트워크 요청만 보내고, 응답을 캐시에 저장하지 않음.

---

**최종 수정일:** 2025-12-26
