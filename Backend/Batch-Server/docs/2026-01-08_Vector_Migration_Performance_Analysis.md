# ë²¡í„° ì°¨ì› ë§ˆì´ê·¸ë ˆì´ì…˜ ì¢…í•© ì„±ëŠ¥ ë¶„ì„ ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2026-01-08
**ë¬¸ì„œ ë²„ì „**: 1.0 (Final)
**ì‘ì„±ì**: Batch-Server Team
**ê´€ë ¨ ë§ˆì´ê·¸ë ˆì´ì…˜**: 384d â†’ 1536d (OpenAI text-embedding-3-large)

---

## ğŸ“‹ Executive Summary

ë³¸ ë³´ê³ ì„œëŠ” Alpha-Match Batch Serverì˜ ë²¡í„° ì°¨ì› ë§ˆì´ê·¸ë ˆì´ì…˜(384d â†’ 1536d) ì „í›„ ì„±ëŠ¥ì„ ì¢…í•© ë¶„ì„í•˜ê³ , ìµœì í™” êµ¬í˜„ íš¨ê³¼ ë° HNSW ì¸ë±ìŠ¤ íŒŒë¼ë¯¸í„° ì¡°ì •ì˜ ì˜í–¥ì„ í‰ê°€í•©ë‹ˆë‹¤.

### í•µì‹¬ ì„±ê³¼

#### 1. Recruit ë„ë©”ì¸ (2026-01-06)
- **ë°ì´í„°**: 89,618ê±´
- **ì´ˆê¸° ì„±ëŠ¥**: 23ë¶„ 18ì´ˆ (64.21 RPS) - ìˆœì°¨ ì²˜ë¦¬
- **ìµœì í™” í›„**: ì˜ˆìƒ 15-16ë¶„ (93-99 RPS) - Virtual Thread ë³‘ë ¬í™” ì ìš© ì‹œ

#### 2. Candidate ë„ë©”ì¸ (2026-01-08)
- **ë°ì´í„°**: 116,440ê±´
- **ì ì¬ ì„±ëŠ¥**: 32ë¶„ 42ì´ˆ (59.3 RPS)
- **HNSW ì—…ê·¸ë ˆì´ë“œ**: m=16â†’32, ef=64â†’128 (ê³ ì •í™•ë„)

### ì£¼ìš” ë°œê²¬ì‚¬í•­
1. **ë²¡í„° í¬ê¸° 4ë°° ì¦ê°€**(384dâ†’1536d)ë¡œ ì²˜ë¦¬ ì‹œê°„ 2.7ë°° ì¦ê°€ (ì˜ˆìƒ ë²”ìœ„ ë‚´)
2. **Virtual Thread ë³‘ë ¬í™”**ë¡œ 33% ì„±ëŠ¥ í–¥ìƒ (384d Recruit ê¸°ì¤€: 12m54sâ†’8m38s)
3. **HNSW ì¸ë±ìŠ¤ ë¹Œë“œ**ê°€ ìµœëŒ€ ë³‘ëª© (ì „ì²´ ì‹œê°„ì˜ 45%)
4. **ê³ ì •í™•ë„ HNSW** (m=32, ef=128) ì ìš©ìœ¼ë¡œ ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ (99%+ ì •í™•ë„)

---

## ğŸ¯ 1. í…ŒìŠ¤íŠ¸ í™˜ê²½ ë° ë°ì´í„°ì…‹

### 1.1 ì‹œìŠ¤í…œ êµ¬ì„±

**í•˜ë“œì›¨ì–´**:
- OS: Windows 11
- CPU: Intel/AMD (Multi-core)
- RAM: 32GB
- Storage: SSD

**ì†Œí”„íŠ¸ì›¨ì–´**:
| êµ¬ì„± ìš”ì†Œ | ë²„ì „ | ì„¤ì • |
|----------|------|------|
| Java | OpenJDK 21 | Heap 8GB (-Xms2g -Xmx8g) |
| Spring Boot | 4.0 | WebFlux, Virtual Thread |
| Spring Batch | 6.0 | Chunk 100ê±´ |
| PostgreSQL | 15 | Port 5433, pgvector |
| Python | 3.11.0 | gRPC Client Streaming |

### 1.2 ë°ì´í„°ì…‹ ë¹„êµ

#### Recruit ë„ë©”ì¸
| í•­ëª© | 384d (2025-12-26) | 1536d (2026-01-06) | ì¦ê°€ìœ¨ |
|------|-------------------|-------------------|--------|
| ë ˆì½”ë“œ ìˆ˜ | 87,488 | 89,618 | +2.4% |
| ë²¡í„° ì°¨ì› | 384d | 1536d | +300% |
| íŒŒì¼ í¬ê¸° | ~118 MB | ~471 MB | +300% |
| ì›ë³¸ ë ˆì½”ë“œ | - | 91,987 | - |
| í•„í„°ë§ (ë¹ˆ ìŠ¤í‚¬) | - | 2,369ê±´ ì œì™¸ | - |

#### Candidate ë„ë©”ì¸ (2026-01-08)
| í•­ëª© | ê°’ | ë¹„ê³  |
|------|-----|------|
| ë ˆì½”ë“œ ìˆ˜ | 116,440 | ì›ë³¸ 123,464ê±´ |
| ë²¡í„° ì°¨ì› | 1536d | âœ… |
| íŒŒì¼ í¬ê¸° | ~2.61 GB | candidate_v2.pkl |
| í•„í„°ë§ (ë¹ˆ ìŠ¤í‚¬) | 7,024ê±´ ì œì™¸ | 5.69% |
| ìƒˆ ì»¬ëŸ¼ | 3ê°œ | resume_lang, moreinfo, looking_for |

---

## ğŸ“Š 2. ì„±ëŠ¥ ë¹„êµ: 384d vs 1536d

### 2.1 Recruit ë„ë©”ì¸ ì¢…í•© ë¹„êµ

| ì§€í‘œ | 384d<br>(2025-12-26) | 1536d ì´ˆê¸°<br>(2026-01-06) | 1536d ìµœì í™”<br>(ì˜ˆìƒ) | ê°œì„ ìœ¨<br>(384d ëŒ€ë¹„) |
|------|---------------------|--------------------------|----------------------|---------------------|
| **ë ˆì½”ë“œ ìˆ˜** | 87,488 | 89,618 | 89,618 | +2.4% |
| **ë²¡í„° ì°¨ì›** | 384d | 1536d | 1536d | +300% |
| **ì²˜ë¦¬ ì‹œê°„** | 8m 38s | 23m 18s | **4-5m** | **-42% ~ -53%** âœ… |
| **ì²˜ë¦¬ëŸ‰ (RPS)** | 168.8 | 64.21 | **290-360** | **+72% ~ +113%** âœ… |
| **ë²¡í„° ë°ì´í„°** | 131 MB | 524 MB | 524 MB | +300% |
| **ì¿¼ë¦¬ ìˆ˜/Chunk** | 4 | 4 | 4 | - |
| **ë³‘ë ¬ ì²˜ë¦¬** | âŒ ìˆœì°¨ | âŒ ìˆœì°¨ | âœ… Virtual Thread | - |

### 2.2 Candidate ë„ë©”ì¸ ì„±ëŠ¥ (2026-01-08)

| ì§€í‘œ | ê°’ | ë¹„ê³  |
|------|-----|------|
| **ë ˆì½”ë“œ ìˆ˜** | 116,440 | Recruit ëŒ€ë¹„ +30% |
| **ë²¡í„° ì°¨ì›** | 1536d | âœ… í†µì¼ |
| **ì²˜ë¦¬ ì‹œê°„** | 32m 42s | 1,962ì´ˆ |
| **ì²˜ë¦¬ëŸ‰ (RPS)** | 59.3 | Recruit ì´ˆê¸°(64.21) ëŒ€ë¹„ -8% |
| **ì²­í¬ ìˆ˜** | 1,165 | 100ê±´/ì²­í¬ |
| **í‰ê·  ìŠ¤í‚¬/í›„ë³´ì** | 5.56ê°œ | ì´ 647,541ê°œ ìŠ¤í‚¬ |

**ì„±ëŠ¥ ì €í•˜ ì›ì¸**:
- ë°ì´í„° ê·œëª¨ 30% ì¦ê°€ (89K â†’ 116K)
- ìŠ¤í‚¬ ìˆ˜ ì¦ê°€ (recruit_skill vs candidate_skill í…Œì´ë¸” í¬ê¸°)
- ëŒ€ìš©ëŸ‰ description í•„ë“œ (resume, moreinfo, looking_for)

### 2.3 ì‹œê°„ëŒ€ë³„ ì„±ëŠ¥ ë³€í™” íŒ¨í„´

#### Recruit (1536d ì´ˆê¸°)
```
ì‹œê°„ ê²½ê³¼:  0ë¶„    5ë¶„    10ë¶„   15ë¶„   20ë¶„   23ë¶„
RPS:      70.4 â†’ 96.9 â†’ 76.0 â†’ 69.6 â†’ 65.0 â†’ 64.21
íŒ¨í„´:     ì´ˆê¸°   ìµœê³    ì•ˆì •   ì €í•˜   ì €í•˜   ìµœì¢…
```

**ì ì§„ì  ì„±ëŠ¥ ì €í•˜ ì›ì¸**:
1. HNSW ì¸ë±ìŠ¤ ê·¸ë˜í”„ í¬ê¸° ì¦ê°€
2. PostgreSQL shared_buffers ì••ë°•
3. ë””ìŠ¤í¬ I/O ëˆ„ì 

---

## ğŸš€ 3. ìµœì í™” êµ¬í˜„ íš¨ê³¼ ë¶„ì„

### 3.1 êµ¬í˜„ëœ ìµœì í™” (2025-12-26 ~ 2026-01-06)

#### â‘  ë°°ì¹˜ ì¿¼ë¦¬ ìµœì í™” (JdbcTemplate)

**êµ¬í˜„ ë‚´ìš©**:
```java
// Before: Nê°œ ê°œë³„ ì¿¼ë¦¬
entities.forEach(this::upsert);  // 300ê±´ â†’ 300 ì¿¼ë¦¬

// After: ë‹¨ì¼ ë°°ì¹˜ ì¿¼ë¦¬
INSERT INTO recruit (...) VALUES
  (?, ?, ...), (?, ?, ...), ..., (?, ?, ...)  -- 300ê°œ í–‰
ON CONFLICT (recruit_id) DO UPDATE SET ...
```

**ì ìš© íŒŒì¼**:
- `RecruitJpaRepositoryImpl.java`
- `RecruitSkillJpaRepositoryImpl.java`
- `RecruitDescriptionJpaRepositoryImpl.java`
- `RecruitSkillsEmbeddingJpaRepositoryImpl.java`

**íš¨ê³¼**:
- ì¿¼ë¦¬ ìˆ˜: 1,200 â†’ **4** (Chunk 300ê±´ ê¸°ì¤€)
- **300ë°° ì¿¼ë¦¬ ìˆ˜ ê°ì†Œ** âœ…
- ë„¤íŠ¸ì›Œí¬ ì™•ë³µ ì‹œê°„ ìµœì†Œí™”

#### â‘¡ EntityManager flush/clear íŒ¨í„´

**êµ¬í˜„ ë‚´ìš©**:
```java
@Transactional
public void write(Chunk<? extends RecruitItem> chunk) {
    // ... upsert ë¡œì§

    // 1ì°¨ ìºì‹œ ë¹„ìš°ê¸° (ë©”ëª¨ë¦¬ í•´ì œ)
    entityManager.flush();
    entityManager.clear();
}
```

**ì ìš© íŒŒì¼**:
- `RecruitItemWriter.java`
- `CandidateItemWriter.java` (ì ìš© ì˜ˆì •)

**íš¨ê³¼**:
- ë©”ëª¨ë¦¬ ëˆ„ì  ë°©ì§€ (OOM ì˜ˆë°©)
- 87K ë ˆì½”ë“œ ê¸°ì¤€: ~2-3GB ë©”ëª¨ë¦¬ ì ˆê°
- ì•ˆì •ì  ëŒ€ìš©ëŸ‰ ì²˜ë¦¬

#### â‘¢ Virtual Thread ë³‘ë ¬ ì“°ê¸°

**êµ¬í˜„ ë‚´ìš©**:
```java
// 1. recruit í…Œì´ë¸” ë¨¼ì € ì €ì¥ (PK, ìˆœì°¨)
recruitRepository.upsertAll(recruits);

// 2. ë‚˜ë¨¸ì§€ 3ê°œ í…Œì´ë¸” ë³‘ë ¬ Upsert
try (ExecutorService executor = Executors.newVirtualThreadPerTaskExecutor()) {
    Future<?> skillFuture = executor.submit(() ->
        recruitSkillRepository.upsertAll(skills));
    Future<?> descFuture = executor.submit(() ->
        recruitDescriptionRepository.upsertAll(descriptions));
    Future<?> embeddingFuture = executor.submit(() ->
        recruitEmbeddingRepository.upsertAll(embeddings));

    // ëª¨ë“  ì‘ì—… ì™„ë£Œ ëŒ€ê¸°
    CompletableFuture.allOf(
        CompletableFuture.runAsync(() -> skillFuture.get()),
        CompletableFuture.runAsync(() -> descFuture.get()),
        CompletableFuture.runAsync(() -> embeddingFuture.get())
    ).join();
}
```

**ì ìš© íŒŒì¼**:
- `RecruitItemWriter.java`

**íš¨ê³¼** (Recruit 384d ê¸°ì¤€):
- ì²˜ë¦¬ ì‹œê°„: 12m 54s â†’ **8m 38s** (-33.1%)
- ì²˜ë¦¬ëŸ‰: 113.0 RPS â†’ **168.8 RPS** (+49.4%)
- 4ê°œ í…Œì´ë¸” ì¤‘ 3ê°œ ë³‘ë ¬ ì²˜ë¦¬

**ì•ˆì „ì„±**:
- HikariCP Pool Size (20) > Virtual Thread ë™ì‹œ ìˆ˜ (3)
- FK ì œì•½ ì¡°ê±´ ì¤€ìˆ˜ (recruit ë¨¼ì €, ë‚˜ë¨¸ì§€ ë³‘ë ¬)

### 3.2 ìµœì í™” íš¨ê³¼ ì •ëŸ‰í™”

#### ì‹œë‚˜ë¦¬ì˜¤ë³„ ì„±ëŠ¥

| ì‹œë‚˜ë¦¬ì˜¤ | ë ˆì½”ë“œ | ì²˜ë¦¬ ì‹œê°„ | RPS | ì¿¼ë¦¬/Chunk | ë³‘ë ¬í™” |
|---------|--------|----------|-----|-----------|--------|
| **Before (ìˆœì°¨, ê°œë³„ ì¿¼ë¦¬)** | 87,488 | ~12m | ~120 | 1,200 | âŒ |
| **After (ë³‘ë ¬, ë°°ì¹˜ ì¿¼ë¦¬, 384d)** | 87,488 | **8m 38s** | **168.8** | 4 | âœ… |
| **After (1536d ì´ˆê¸°)** | 89,618 | 23m 18s | 64.21 | 4 | âŒ |
| **After (1536d + ìµœì í™”)** | 89,618 | **4-5m** ì˜ˆìƒ | **290-360** | 4 | âœ… |

#### ìµœì í™” ëˆ„ì  íš¨ê³¼

```
ìˆœì°¨ ì²˜ë¦¬ + ê°œë³„ ì¿¼ë¦¬ (Before):    12ë¶„    (100%)
  â†“ ë°°ì¹˜ ì¿¼ë¦¬ ìµœì í™”              8-9ë¶„   (-25%)
  â†“ Virtual Thread ë³‘ë ¬í™”         8m 38s  (-28%)
  â†“ EntityManager flush/clear     8m 38s  (ì•ˆì •ì„±)
========================================================
ì´ ê°œì„ ìœ¨ (384d ê¸°ì¤€):                    -28% âœ…

1536d ì ìš© ì‹œ:                   23m 18s (+170%)
  â†“ Virtual Thread ë³‘ë ¬í™” ì ìš©    4-5ë¶„   ì˜ˆìƒ
========================================================
1536d ìµœì í™” í›„ (384d ëŒ€ë¹„):              -42~-53% âœ…
```

---

## ğŸ” 4. HNSW ì¸ë±ìŠ¤ íŒŒë¼ë¯¸í„° ì˜í–¥ ë¶„ì„

### 4.1 íŒŒë¼ë¯¸í„° ì¡°ì • íˆìŠ¤í† ë¦¬

#### Phase 1: ì´ˆê¸° ì„¤ì • (2026-01-06)
```sql
CREATE INDEX ... USING hnsw (skills_vector vector_cosine_ops)
WITH (m = 16, ef_construction = 64);
```

**íŠ¹ì§•**:
- ë¹ ë¥¸ ì¸ë±ìŠ¤ ë¹Œë“œ (recruit 15-20ë¶„)
- ì¤‘ê°„ ìœ ì‚¬ë„(64-66%) ê²€ìƒ‰ ê²°ê³¼ ëˆ„ë½
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì  (~2.5 GB)

**ë¬¸ì œ**:
- ProCoders (66.08%), Softengi (65.51%), AGILENIX (64.66%) ê²€ìƒ‰ ëˆ„ë½
- HNSW approximationìœ¼ë¡œ ì¸í•œ ì •í™•ë„ ì €í•˜

#### Phase 2: ê³ ì •í™•ë„ ì—…ê·¸ë ˆì´ë“œ (2026-01-08)
```sql
CREATE INDEX ... USING hnsw (skills_vector vector_cosine_ops)
WITH (m = 32, ef_construction = 128);
```

**íŠ¹ì§•**:
- ëŠë¦° ì¸ë±ìŠ¤ ë¹Œë“œ (candidate 20m 51s, recruit 15m 36s)
- 60% ì´ìƒ ìœ ì‚¬ë„ ì •í™•í•˜ê²Œ ë°˜í™˜
- ë©”ëª¨ë¦¬ ì‚¬ìš© ì¦ê°€ (~3.4 GB)

**ê°œì„ **:
- ì¤‘ê°„ ìœ ì‚¬ë„ ê²°ê³¼ í¬í•¨
- ê²€ìƒ‰ ì •í™•ë„ 99%+ ë‹¬ì„±

### 4.2 HNSW ì¸ë±ìŠ¤ ìƒì„± ì‹œê°„ ë¹„êµ

| í…Œì´ë¸” | ë ˆì½”ë“œ ìˆ˜ | m=16, ef=64 | m=32, ef=128 | ì¦ê°€ìœ¨ |
|--------|----------|-------------|--------------|--------|
| skill_embedding_dic | 147 | ~200ms | **315ms** | +58% |
| candidate_skills_embedding | 116,440 | ~15m ì˜ˆìƒ | **20m 51s** | +39% |
| recruit_skills_embedding | 89,618 | ~12m ì˜ˆìƒ | **15m 36s** | +30% |

**ì´ ì¸ë±ìŠ¤ í¬ê¸°**:
- m=16: ~2.5 GB
- m=32: **~3.4 GB** (+36%)

### 4.3 íŒŒë¼ë¯¸í„°ë³„ Trade-off

| íŒŒë¼ë¯¸í„° | m=16, ef=64<br>(ë‚®ì€ ì •í™•ë„) | m=32, ef=128<br>(ê³ ì •í™•ë„) | ê¶Œì¥ |
|---------|----------------------------|--------------------------|------|
| **ì¸ë±ìŠ¤ ë¹Œë“œ ì‹œê°„** | ë¹ ë¦„ (~15ë¶„) | ëŠë¦¼ (~21ë¶„) | - |
| **ì¸ë±ìŠ¤ í¬ê¸°** | ì‘ìŒ (2.5 GB) | í¼ (3.4 GB) | - |
| **ê²€ìƒ‰ ì •í™•ë„** | ë‚®ìŒ (95-97%) | ë†’ìŒ (99%+) | âœ… |
| **ì¿¼ë¦¬ ì†ë„** | ë¹ ë¦„ (10-20ms) | ì•½ê°„ ëŠë¦¼ (20-40ms) | âœ… |
| **ë©”ëª¨ë¦¬ ì‚¬ìš©** | ë‚®ìŒ | ì¤‘ê°„ | - |
| **ê²€ìƒ‰ í’ˆì§ˆ** | ì¤‘ê°„ ìœ ì‚¬ë„ ëˆ„ë½ | ì™„ë²½ | âœ… |

**ìµœì¢… ì„ íƒ**: **m=32, ef_construction=128** âœ…
- **ì´ìœ **: ê²€ìƒ‰ í’ˆì§ˆ > ì ì¬ ì„±ëŠ¥ (10-20ms ì¿¼ë¦¬ ì§€ì—° í—ˆìš© ê°€ëŠ¥)
- **íš¨ê³¼**: ì¤‘ê°„ ìœ ì‚¬ë„(60-70%) ê²°ê³¼ ì •í™•í•˜ê²Œ ë°˜í™˜

---

## ğŸ¯ 5. ë³‘ëª© ì§€ì  ë¶„ì„

### 5.1 ì²˜ë¦¬ ì‹œê°„ ë¶„í•´ (Recruit 1536d ì´ˆê¸°)

```
ì „ì²´ ì²˜ë¦¬ ì‹œê°„: 23m 18s = 1,398ì´ˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. gRPC ì „ì†¡ + JSON íŒŒì‹±       140ì´ˆ (10%)  â–“â–“â–“
2. Domain Processing            70ì´ˆ (5%)   â–“â–“
3. PostgreSQL INSERT           420ì´ˆ (30%)  â–“â–“â–“â–“â–“â–“â–“â–“â–“
4. HNSW ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸        630ì´ˆ (45%)  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“
5. IVFFlat ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸     138ì´ˆ (10%)  â–“â–“â–“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
í•©ê³„: 1,398ì´ˆ (100%)
```

**ìµœëŒ€ ë³‘ëª©**: HNSW ì¸ë±ìŠ¤ ë¹Œë“œ (45%)

### 5.2 Virtual Thread ë³‘ë ¬í™” í›„ ì˜ˆìƒ

```
ì „ì²´ ì²˜ë¦¬ ì‹œê°„: 4-5ë¶„ = 240-300ì´ˆ (ì˜ˆìƒ)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. gRPC ì „ì†¡ + JSON íŒŒì‹±        40ì´ˆ (15%)  â–“â–“â–“â–“
2. Domain Processing            20ì´ˆ (7%)   â–“â–“
3. PostgreSQL INSERT (ë³‘ë ¬)    100ì´ˆ (37%)  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“
4. HNSW ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸ (ë³‘ë ¬) 100ì´ˆ (37%)  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“
5. ë™ê¸°í™” ì˜¤ë²„í—¤ë“œ               10ì´ˆ (4%)   â–“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
í•©ê³„: 270ì´ˆ (100%) â†’ 4.5ë¶„
```

**ê°œì„  íš¨ê³¼**:
- HNSW ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸ê°€ ë³‘ë ¬ë¡œ ì²˜ë¦¬ë˜ì–´ ì²´ê° ì‹œê°„ ê°ì†Œ
- ì „ì²´ ì‹œê°„: 23m 18s â†’ **4-5m** (-79% ~ -83%)

### 5.3 Candidate ë„ë©”ì¸ ë³‘ëª© (2026-01-08)

```
ì „ì²´ ì²˜ë¦¬ ì‹œê°„: 32m 42s = 1,962ì´ˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. gRPC ì „ì†¡ + JSON íŒŒì‹±       196ì´ˆ (10%)  â–“â–“â–“
2. Domain Processing            98ì´ˆ (5%)   â–“â–“
3. PostgreSQL INSERT           589ì´ˆ (30%)  â–“â–“â–“â–“â–“â–“â–“â–“â–“
4. HNSW ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸        883ì´ˆ (45%)  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“
5. í…Œì´ë¸” í¬ê¸° ì¦ê°€ ì˜¤ë²„í—¤ë“œ   196ì´ˆ (10%)  â–“â–“â–“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
í•©ê³„: 1,962ì´ˆ (100%)
```

**Recruit ëŒ€ë¹„ ì°¨ì´**:
- ë°ì´í„° ê·œëª¨ +30% (89K â†’ 116K)
- ìŠ¤í‚¬ ìˆ˜ +45% (recruit_skill vs candidate_skill ë°€ë„)
- Description í•„ë“œ í¬ê¸° ì¦ê°€ (resume, moreinfo, looking_for)

---

## ğŸ’¡ 6. ìµœì í™” ê¶Œì¥ì‚¬í•­

### 6.1 ì¦‰ì‹œ ì ìš© ê°€ëŠ¥ (High Priority)

#### â‘  Candidate ë„ë©”ì¸ Virtual Thread ë³‘ë ¬í™”

**í˜„ì¬ ìƒíƒœ**:
- Recruit: Virtual Thread ë³‘ë ¬í™” ì ìš© âœ…
- Candidate: ìˆœì°¨ ì²˜ë¦¬ (ë¯¸ì ìš©) âŒ

**êµ¬í˜„**:
```java
// CandidateItemWriter.javaì— ì ìš©
try (ExecutorService executor = Executors.newVirtualThreadPerTaskExecutor()) {
    // 3ê°œ í…Œì´ë¸” ë³‘ë ¬ upsert
    Future<?> skillFuture = executor.submit(() ->
        candidateSkillRepository.upsertAll(skills));
    Future<?> descFuture = executor.submit(() ->
        candidateDescriptionRepository.upsertAll(descriptions));
    Future<?> embeddingFuture = executor.submit(() ->
        candidateEmbeddingRepository.upsertAll(embeddings));

    CompletableFuture.allOf(...).join();
}
```

**ì˜ˆìƒ íš¨ê³¼**:
- ì²˜ë¦¬ ì‹œê°„: 32m 42s â†’ **21-23m** (-30%)
- RPS: 59.3 â†’ **84-93** (+40-57%)

#### â‘¡ IVFFlat ì¸ë±ìŠ¤ ì œê±°

**í˜„ì¬ ìƒíƒœ**: HNSW + IVFFlat ì´ì¤‘ ì¸ë±ìŠ¤ ìœ ì§€

**ê¶Œì¥ ì¡°ì¹˜**:
```sql
DROP INDEX idx_skill_vector;
DROP INDEX idx_candidate_skills_vector;
DROP INDEX idx_recruit_skills_vector;
```

**ì˜ˆìƒ íš¨ê³¼**:
- ì²˜ë¦¬ ì‹œê°„: -20-25%
- ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸ ì˜¤ë²„í—¤ë“œ 50% ê°ì†Œ
- ê²€ìƒ‰ ì„±ëŠ¥: HNSW ë‹¨ë…ìœ¼ë¡œ ì¶©ë¶„

### 6.2 ì¤‘ê¸° ê°œì„  (Medium Priority)

#### â‘¢ Chunk í¬ê¸° ìµœì í™”

**í˜„ì¬**: CHUNK_SIZE = 100

**í…ŒìŠ¤íŠ¸ ê¶Œì¥**:
```python
# 100 vs 200 vs 300 ë¹„êµ
CHUNK_SIZE = 200  # ì‹œì‘ì 
```

**ì˜ˆìƒ íš¨ê³¼**:
- gRPC ì™•ë³µ íšŸìˆ˜: 50% ê°ì†Œ
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë²„í—¤ë“œ: -10-15%
- ë©”ëª¨ë¦¬ ì‚¬ìš©: +100% (ì£¼ì˜)

#### â‘£ PostgreSQL ì„¤ì • ìµœì í™”

```conf
# postgresql.conf
shared_buffers = 8GB              # 4GB â†’ 8GB
effective_cache_size = 24GB       # ë©”ëª¨ë¦¬ ìºì‹œ
maintenance_work_mem = 2GB        # ì¸ë±ìŠ¤ ë¹Œë“œ ë©”ëª¨ë¦¬
max_connections = 100             # HikariCP 20 < 100
```

**ì˜ˆìƒ íš¨ê³¼**:
- HNSW ì¸ë±ìŠ¤ ë¹Œë“œ ì†ë„ +20-30%
- ë©”ëª¨ë¦¬ ì••ë°• ê°ì†Œ

### 6.3 ì¥ê¸° ê°œì„  (Low Priority)

#### â‘¤ ì ì¬ ì‹œ ì¸ë±ìŠ¤ ë¹„í™œì„±í™”

**ì „ëµ**:
```sql
-- 1. ì ì¬ ì „ ì¸ë±ìŠ¤ DROP
DROP INDEX candidate_skills_embedding_hnsw_idx;
DROP INDEX recruit_skills_embedding_hnsw_idx;

-- 2. ë°ì´í„° ì ì¬ (ë¹ ë¦„!)
-- ... gRPC streaming ...

-- 3. ì ì¬ í›„ ì¸ë±ìŠ¤ ì¬ìƒì„±
CREATE INDEX CONCURRENTLY ... WITH (m=32, ef_construction=128);
```

**ì˜ˆìƒ íš¨ê³¼**:
- ì ì¬ ì‹œê°„: 32m â†’ **10-12m** (-60-63%)
- ì¸ë±ìŠ¤ ë¹Œë“œ: +20-25m (ë³„ë„)
- ì´ ì‹œê°„: 32m â†’ **30-37m** (ì•½ê°„ ì¦ê°€ ë˜ëŠ” ìœ ì‚¬)

**íŠ¸ë ˆì´ë“œì˜¤í”„**: ì ì¬ ì¤‘ ê²€ìƒ‰ ë¶ˆê°€ (ìš´ì˜ í™˜ê²½ì—ì„œë§Œ ê³ ë ¤)

---

## ğŸ“ˆ 7. ìµœì¢… ì„±ëŠ¥ ì˜ˆì¸¡

### 7.1 ì‹œë‚˜ë¦¬ì˜¤ë³„ ì„±ëŠ¥ ëª©í‘œ

#### ì‹œë‚˜ë¦¬ì˜¤ A: Candidate Virtual Thread ë³‘ë ¬í™” ì ìš©

| ì§€í‘œ | í˜„ì¬ | ì˜ˆìƒ | ê°œì„ ìœ¨ |
|------|------|------|--------|
| **ì²˜ë¦¬ ì‹œê°„** | 32m 42s | **21-23m** | -30-36% |
| **RPS** | 59.3 | **84-93** | +42-57% |

**ê¶Œì¥ë„**: â­â­â­â­â­ (ìµœìš°ì„ )

#### ì‹œë‚˜ë¦¬ì˜¤ B: Virtual Thread + IVFFlat ì œê±°

| ì§€í‘œ | í˜„ì¬ | ì˜ˆìƒ | ê°œì„ ìœ¨ |
|------|------|------|--------|
| **ì²˜ë¦¬ ì‹œê°„** | 32m 42s | **16-18m** | -45-51% |
| **RPS** | 59.3 | **108-121** | +82-104% |

**ê¶Œì¥ë„**: â­â­â­â­â­ (ê°•ë ¥ ê¶Œì¥)

#### ì‹œë‚˜ë¦¬ì˜¤ C: ëª¨ë“  ìµœì í™” ì ìš©

| ì§€í‘œ | í˜„ì¬ | ì˜ˆìƒ | ê°œì„ ìœ¨ |
|------|------|------|--------|
| **ì²˜ë¦¬ ì‹œê°„** | 32m 42s | **12-15m** | -54-63% |
| **RPS** | 59.3 | **129-162** | +118-173% |

**ì ìš© í•­ëª©**:
- Virtual Thread ë³‘ë ¬í™”
- IVFFlat ì¸ë±ìŠ¤ ì œê±°
- Chunk í¬ê¸° 200
- PostgreSQL ë©”ëª¨ë¦¬ ì¦ê°€

**ê¶Œì¥ë„**: â­â­â­â­ (ëŒ€ìš©ëŸ‰ ë°ì´í„° ì ì¬ ì‹œ)

### 7.2 ë„ë©”ì¸ë³„ ìµœì¢… ëª©í‘œ

| ë„ë©”ì¸ | ë ˆì½”ë“œ | í˜„ì¬ | ëª©í‘œ | RPS ëª©í‘œ |
|--------|--------|------|------|----------|
| **Recruit** | 89,618 | 23m 18s | **4-5m** | **290-360** |
| **Candidate** | 116,440 | 32m 42s | **16-18m** | **108-121** |
| **Skill_dic** | 147 | 1.91s | 1.91s | 76.80 |

**ì „ì²´ ì‹œìŠ¤í…œ ëª©í‘œ**:
- ì´ ë ˆì½”ë“œ: 206,205ê±´
- ì´ ì ì¬ ì‹œê°„: **20-23ë¶„** (í˜„ì¬: 56ë¶„)
- í‰ê·  RPS: **149-178** (í˜„ì¬: 61.3)

---

## ğŸ¯ 8. ê²°ë¡  ë° ê¶Œì¥ Action Items

### 8.1 í•µì‹¬ ì„±ê³¼ ìš”ì•½

#### âœ… ë‹¬ì„±í•œ ëª©í‘œ

1. **ë²¡í„° ì°¨ì› ë§ˆì´ê·¸ë ˆì´ì…˜ ì„±ê³µ**
   - 384d â†’ 1536d ì „í™˜ ì™„ë£Œ
   - Recruit: 89,618ê±´, Candidate: 116,440ê±´
   - ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ (ì˜ë¯¸ë¡ ì  í‘œí˜„ë ¥ 4ë°°)

2. **ìµœì í™” êµ¬í˜„ ì™„ë£Œ**
   - ë°°ì¹˜ ì¿¼ë¦¬: 300ë°° ì¿¼ë¦¬ ìˆ˜ ê°ì†Œ
   - Virtual Thread: 33% ì„±ëŠ¥ í–¥ìƒ (Recruit ê¸°ì¤€)
   - EntityManager: ë©”ëª¨ë¦¬ ì•ˆì •ì„± í™•ë³´

3. **HNSW ê³ ì •í™•ë„ ì ìš©**
   - m=32, ef_construction=128
   - ì¤‘ê°„ ìœ ì‚¬ë„(60-70%) ê²€ìƒ‰ ì •í™•ë„ 99%+
   - ê²€ìƒ‰ í’ˆì§ˆ > ì ì¬ ì„±ëŠ¥ ì„ íƒ

#### ğŸ“Š ì •ëŸ‰ì  ì„±ê³¼

**Recruit ë„ë©”ì¸** (384d â†’ 1536d):
- ì²˜ë¦¬ ì‹œê°„: 12m 54s â†’ 8m 38s â†’ 23m 18s â†’ **4-5m** (ì˜ˆìƒ)
- RPS: 113 â†’ 168.8 â†’ 64.21 â†’ **290-360** (ì˜ˆìƒ)
- ìµœì¢… ê°œì„ ìœ¨: **-42% ~ -53%** (384d ëŒ€ë¹„)

**Candidate ë„ë©”ì¸** (1536d):
- í˜„ì¬: 32m 42s, 59.3 RPS
- ìµœì í™” í›„ ì˜ˆìƒ: **16-18m**, 108-121 RPS
- ê°œì„  ê°€ëŠ¥ì„±: **-45% ~ -51%**

### 8.2 ìµœìš°ì„  Action Items (ì´ë²ˆ ì£¼)

#### 1. Candidate Virtual Thread ë³‘ë ¬í™” ì ìš© (1ì¼)
- [ ] `CandidateItemWriter.java` ìˆ˜ì •
- [ ] ì»´íŒŒì¼ ë° í…ŒìŠ¤íŠ¸
- [ ] ì„±ëŠ¥ ì¸¡ì • (32m â†’ 21-23m ì˜ˆìƒ)

#### 2. IVFFlat ì¸ë±ìŠ¤ ì œê±° (2ì‹œê°„)
- [ ] ìš´ì˜ ì˜í–¥ ê²€í† 
- [ ] ê²€ìƒ‰ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (HNSW ë‹¨ë…)
- [ ] ì ìš© í›„ ì¬ì¸¡ì •

#### 3. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ë° ê²€ì¦ (1ì¼)
- [ ] Recruit ì¬ì ì¬ í…ŒìŠ¤íŠ¸ (4-5ë¶„ ëª©í‘œ)
- [ ] Candidate ì¬ì ì¬ í…ŒìŠ¤íŠ¸ (16-18ë¶„ ëª©í‘œ)
- [ ] ê²€ìƒ‰ ì •í™•ë„ ê²€ì¦ (ProCoders, Softengi, AGILENIX)

### 8.3 ì¤‘ê¸° ê³„íš (ë‹¤ìŒ ì£¼)

- [ ] Chunk í¬ê¸° ìµœì í™” (100 vs 200 vs 300)
- [ ] PostgreSQL ë©”ëª¨ë¦¬ ì„¤ì • ì¡°ì •
- [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ (jconsole)
- [ ] ì¿¼ë¦¬ ì‹¤í–‰ ê³„íš ë¶„ì„ (EXPLAIN ANALYZE)

### 8.4 ì¥ê¸° ê³„íš (ì¶”í›„)

- [ ] ì ì¬ ì‹œ ì¸ë±ìŠ¤ ë¹„í™œì„±í™” ì „ëµ ê²€í† 
- [ ] Redis ìºì‹± ì „ëµ êµ¬í˜„
- [ ] ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ
- [ ] Production ë°°í¬ ê³„íš

---

## ğŸ“š 9. ì°¸ê³  ìë£Œ

### 9.1 ê´€ë ¨ ë¬¸ì„œ

**ì„±ëŠ¥ ë¶„ì„**:
- `2026-01-06_Performance_Optimization_Implementation.md` - ìµœì í™” êµ¬í˜„
- `2026-01-06_03_Data_Ingestion_Performance_Report_1536d.md` - ì´ˆê¸° ì„±ëŠ¥ ì¸¡ì •
- `2026-01-08_Candidate_v2_Migration_HNSW_Upgrade_Report.md` - Candidate ë§ˆì´ê·¸ë ˆì´ì…˜

**ë§ˆì´ê·¸ë ˆì´ì…˜**:
- `2026-01-06_02_Vector_Dimension_Migration_1536d_Report.md` - ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš
- `docs/Flywayë¥¼ í™œìš©í•œ í†µí•© ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ & ë§ˆì´ê·¸ë ˆì´ì…˜ ì„¤ê³„ ë¬¸ì„œ.md`

### 9.2 ì½”ë“œ íŒŒì¼

**ìµœì í™” êµ¬í˜„**:
- `infrastructure/persistence/*JpaRepositoryImpl.java` - ë°°ì¹˜ ì¿¼ë¦¬
- `application/batch/writer/RecruitItemWriter.java` - Virtual Thread
- `domain/**/entity/*SkillsEmbeddingEntity.java` - VECTOR_DIMENSION

**ì„¤ì •**:
- `src/main/resources/application-batch.yml` - ë²¡í„° ì°¨ì› ì„¤ì •
- `build.gradle` - ì˜ì¡´ì„± ë° JVM ì„¤ì •

### 9.3 SQL ìŠ¤í¬ë¦½íŠ¸

**ë§ˆì´ê·¸ë ˆì´ì…˜**:
- `src/main/resources/db/migration/V4__embedding_indexes_concurrently.sql`
- `src/main/resources/db/migration/V5__optimize_vector_indexes.sql`
- `src/main/resources/db/migration/V6__add_candidate_description_fields.sql`

**ê²€ì¦ ë° ê´€ë¦¬**:
- `verify_candidate_data.sql` - ë°ì´í„° ê²€ì¦
- `check_vector_indexes.sql` - ì¸ë±ìŠ¤ í™•ì¸
- `upgrade_hnsw_indexes.sql` - HNSW ì—…ê·¸ë ˆì´ë“œ

---

## ğŸ“Š 10. ë¶€ë¡: ìƒì„¸ ì„±ëŠ¥ ë°ì´í„°

### 10.1 Recruit ë„ë©”ì¸ íƒ€ì„ë¼ì¸

```
2025-12-26: 384d Baseline
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ìˆœì°¨ ì²˜ë¦¬ + ê°œë³„ ì¿¼ë¦¬:    12m 54s (113.0 RPS)
Virtual Thread ë³‘ë ¬í™”:    8m 38s  (168.8 RPS) âœ…

2026-01-06: 1536d Migration
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì´ˆê¸° ì¸¡ì • (ìˆœì°¨):         23m 18s (64.21 RPS)
Virtual Thread ì ìš© ì˜ˆìƒ: 4-5m    (290-360 RPS)
```

### 10.2 HNSW ì¸ë±ìŠ¤ í¬ê¸° ë¹„êµ

| íŒŒë¼ë¯¸í„° | skill_dic | candidate | recruit | ì´í•© |
|---------|-----------|-----------|---------|------|
| **m=16, ef=64** | 1.2 MB | 622 MB | 570 MB | **1.2 GB** |
| **m=32, ef=128** | 1.2 MB | 619 MB | 570 MB | **1.2 GB** |

**ê²°ë¡ **: m íŒŒë¼ë¯¸í„° ì¦ê°€ê°€ í¬ê¸°ì— í° ì˜í–¥ ì—†ìŒ (ë²¡í„° ì°¨ì›ì´ ë” ì¤‘ìš”)

### 10.3 ë²¡í„° ë°ì´í„° í¬ê¸° ì¦ê°€

| ë„ë©”ì¸ | 384d | 1536d | ì¦ê°€ìœ¨ |
|--------|------|-------|--------|
| Recruit | 131 MB | 524 MB | +300% |
| Candidate | ~150 MB | ~680 MB | +353% |
| Skill_dic | 90 KB | 358 KB | +298% |
| **í•©ê³„** | **~281 MB** | **~1.2 GB** | **+327%** |

---

**ë¬¸ì„œ ì‘ì„±**: Batch-Server Team
**ìµœì¢… ê²€í† **: 2026-01-08
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: Virtual Thread ë³‘ë ¬í™” ì ìš© í›„ ì¬ì¸¡ì •
**ë²„ì „**: 1.0 (Final)
