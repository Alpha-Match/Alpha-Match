# ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

**ì‘ì„±ì¼:** 2025-12-10
**ì—…ë°ì´íŠ¸:** 2025-12-10

---

## ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í”„ë¡ íŠ¸ì—”ë“œ (Next.js 16.0.7)                â”‚
â”‚  - React Query (ìºì‹±)                                         â”‚
â”‚  - GraphQL Client                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                               â”‚ GraphQL
                â”‚                               â”‚ ìš”ì²­/ì‘ë‹µ
                â”‚                               â”‚
        (ì‚¬ìš©ì ìš”ì²­)                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ë°±ì—”ë“œ API ì„œë²„ (Spring WebFlux)                â”‚
â”‚  - GraphQL API                                               â”‚
â”‚  - Caffeine/Redis ìºì‹±                                       â”‚
â”‚  - gRPC Client (AI ì„œë²„ í˜¸ì¶œ)                                â”‚
â”‚  - PostgreSQL ì¡°íšŒ (pgvector)                                â”‚
â”‚  - gRPC Server (ìºì‹œ ë¬´íš¨í™” ìˆ˜ì‹ )                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                      â”‚
                â”‚ gRPC                 â”‚ DB ì¡°íšŒ/ì €ì¥
                â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI Backend (PyTorch)   â”‚   â”‚    PostgreSQL + pgvector      â”‚
â”‚  - Embedding ìƒì„±         â”‚   â”‚  - ì‚¬ìš©ì/ê³µê³  ë²¡í„° ì €ì¥       â”‚
â”‚  - ì¶”ì²œ ëª¨ë¸ ì¶”ë¡          â”‚   â”‚  - ìœ ì‚¬ë„ ê²€ìƒ‰ (<-> ì—°ì‚°ì)    â”‚
â”‚  - gRPC Streaming ì„œë²„    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â–²
                â”‚ gRPC Stream                   â”‚
                â”‚ (Embedding Data)               â”‚
                â–¼                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ë°±ì—”ë“œ Batch ì„œë²„ (Spring Batch)                   â”‚
â”‚  - Pythonìœ¼ë¡œë¶€í„° Embedding ìˆ˜ì‹  (gRPC Streaming)             â”‚
â”‚  - Chunk ë‹¨ìœ„ Batch Upsert                                   â”‚
â”‚  - Checkpoint ê´€ë¦¬ (ì¬ì‹œì‘ ì§€ì›)                              â”‚
â”‚  - API ì„œë²„ì— ìºì‹œ ë¬´íš¨í™” ìš”ì²­                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ

| ê³„ì¸µ | êµ¬ì„± ìš”ì†Œ | ê¸°ìˆ  ìŠ¤íƒ | í¬íŠ¸ | ì—­í•  |
|-----|---------|---------|-----|-----|
| **Frontend** | Front-Server | Next.js 16.0.7, React Query | 3000 | GraphQL API ì†Œë¹„, ë°ì´í„° ìºì‹± |
| **Backend (API)** | Api-Server | Spring WebFlux + GraphQL | 8080, 50052 | ì¡°íšŒ API ì œê³µ, ìºì‹±, gRPC í†µì‹  |
| **AI Backend** | Demo-Python | Python + gRPC | 50051 | Embedding ìƒì„± ë° ìŠ¤íŠ¸ë¦¬ë° |
| **Batch** | Batch-Server | Spring Batch + gRPC Client | N/A | Embedding ìˆ˜ì‹  ë° DB ì €ì¥ |
| **Database** | PostgreSQL | pgvector | 5432 | Vector ì €ì¥ ë° ìœ ì‚¬ë„ ê²€ìƒ‰ |
| **Cache** | Redis | - | 6379 | ë¶„ì‚° ìºì‹± |

---

## í†µì‹  í”„ë¡œí† ì½œ

### 1. Frontend â†” API Server
- **í”„ë¡œí† ì½œ:** GraphQL over HTTP
- **í¬íŠ¸:** 8080
- **ìš©ë„:** ë°ì´í„° ì¡°íšŒ ë° ë³€ê²½

### 2. API Server â†” AI Backend
- **í”„ë¡œí† ì½œ:** gRPC (Client â†’ Server)
- **í¬íŠ¸:** 50051
- **ìš©ë„:** Embedding ìƒì„±, ì¶”ì²œ ìš”ì²­

### 3. Batch Server â†” AI Backend
- **í”„ë¡œí† ì½œ:** gRPC Streaming (Client â†’ Server)
- **í¬íŠ¸:** 50051
- **ìš©ë„:** ëŒ€ìš©ëŸ‰ Embedding ë°ì´í„° ìˆ˜ì‹ 

### 4. Batch Server â†’ API Server
- **í”„ë¡œí† ì½œ:** gRPC Unary (Client â†’ Server)
- **í¬íŠ¸:** 50052
- **ìš©ë„:** ìºì‹œ ë¬´íš¨í™” ìš”ì²­

### 5. ëª¨ë“  ì„œë²„ â†” PostgreSQL
- **í”„ë¡œí† ì½œ:** JDBC / R2DBC
- **í¬íŠ¸:** 5432
- **ìš©ë„:** ë°ì´í„° ì €ì¥/ì¡°íšŒ

---

## ì£¼ìš” ê¸°ìˆ  ì„ íƒ ì´ìœ 

### Reactive Programming (WebFlux)
- **ì´ìœ :** ê³ ì„±ëŠ¥ ë¹„ë™ê¸° ì²˜ë¦¬, Non-blocking I/O
- **ì¥ì :** ì ì€ ë¦¬ì†ŒìŠ¤ë¡œ ë§ì€ ìš”ì²­ ì²˜ë¦¬ ê°€ëŠ¥
- **ì ìš©:** API Server

### gRPC
- **ì´ìœ :** HTTP/2 ê¸°ë°˜ ê³ ì„±ëŠ¥ RPC, Streaming ì§€ì›
- **ì¥ì :** Protocol Buffersë¡œ íš¨ìœ¨ì ì¸ ì§ë ¬í™”
- **ì ìš©:** ì„œë²„ ê°„ í†µì‹  ì „ì²´

### pgvector
- **ì´ìœ :** PostgreSQL ê¸°ë°˜ Vector DB í™•ì¥
- **ì¥ì :** ê¸°ì¡´ RDBMS í™œìš©, SQLë¡œ Vector ê²€ìƒ‰ ê°€ëŠ¥
- **ì ìš©:** Embedding ì €ì¥ ë° ìœ ì‚¬ë„ ê²€ìƒ‰

### React Query
- **ì´ìœ :** ì„œë²„ ìƒíƒœ ê´€ë¦¬ ë° ìºì‹±
- **ì¥ì :** API í˜¸ì¶œ ìµœì†Œí™”, ìë™ ì¬ìš”ì²­
- **ì ìš©:** Frontend

---

## í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### ìˆ˜í‰ í™•ì¥ (Horizontal Scaling)
- **API Server:** Stateless ì„¤ê³„ë¡œ ë‹¤ì¤‘ ì¸ìŠ¤í„´ìŠ¤ ë°°í¬ ê°€ëŠ¥
- **Batch Server:** ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ ê¶Œì¥ (Checkpoint ê´€ë¦¬)
- **AI Backend:** ëª¨ë¸ ë¡œë”© ë¹„ìš© ê³ ë ¤, í•„ìš”ì‹œ ë¡œë“œ ë°¸ëŸ°ì‹±

### ì„±ëŠ¥ ìµœì í™”
- **DB Connection Pool:** HikariCP ì„¤ì • ìµœì í™”
- **gRPC Message Size:** ìµœëŒ€ 100MB ì„¤ì •
- **Chunk Size:** ë„¤íŠ¸ì›Œí¬ ìƒí™©ì— ë”°ë¼ ì¡°ì • (100~500)

### ì¥ì•  ëŒ€ì‘
- **Circuit Breaker:** gRPC í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ìë™ ì°¨ë‹¨
- **Retry:** Exponential Backoff ì ìš©
- **DLQ:** ì‹¤íŒ¨ ë°ì´í„° ë³„ë„ ì €ì¥ ë° ì¬ì²˜ë¦¬

---

## ê´€ë ¨ ë¬¸ì„œ
- [ë°ì´í„° í”Œë¡œìš°](./ë°ì´í„°_í”Œë¡œìš°.md)
- [Entire Structure](../Backend/Batch-Server/docs/Entire_Structure.md)
